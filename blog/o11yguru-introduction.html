<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="content-language" content="en">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>o11y.guru introduction and first set of iterations</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Part of the o11y.guru series this post is an introduction for this side project and it describes the first architecture designed for the website.">
    <meta name="keywords" content="o11y.guru, introduction, side project, twitter">
    <meta name="google-site-verification" content="FoOIQ005srOjHlH19pNWapHvlOOVgCqHsz47IfQ6QNo" />
    <link rel="canonical" href="https://gianarb.it/blog/o11yguru-introduction">
    <link rel="icon" type="image/png" href="/img/favicon.png" />

    <link rel='alternate' type='application/atom+xml' title='Atom 0.3' href='/atom.xml'>

    <link rel="stylesheet" href="/assets/css/main.css">

</head>

    <body>
      <script>
            function advchecker() {
               document.getElementById('adv-sponsor').style.display = "block";
            }
      </script>
      <!--<div class="carbon-banner">-->
      <!--<script async style="display:none;" onerror="advchecker()" type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7DLK7L&placement=gianarbit" id="_carbonads_js"></script>-->
<!--</div>-->

<h1>o11y.guru introduction and first set of iterations</h1>
<main>
    <p class="meta">09 Nov 2019 · <!-- thanks to https://www.davidputney.com/2016/07/how-medium-style-read-time-estimate.html -->


<span class="blog-read-time">Nine minute read</span>
 · on <a href="/blog">Gianluca's blog</a></p>

<p style="display:none;" class="note" id="adv-sponsor">Hey! I see you use an adblocker as I do as
well! I use Carbon Adv to support this tiny website a network with developers
in mind. Please consider disabling the adblocker for this website to support my
work.</p>

    <article>
    <div class="jumbotron">

  <h2 id="introduction">Introduction</h2>

  <p>This article is part of a series I am writing about a
side project I made called <a href="https://o11y.guru">o11y.guru</a>. Who knows what this
series or the project itself will become. The reason why I started it was to
have my <strong>wonderland</strong>. A place where I was able to do my mistakes without any
intermediary.</p>

  <p>This series is about my journey there. I will keep the this <code>Introduction</code>
common to all the articles part of this series and I will keep a <code>Table of
Content</code> up to date. The best way to follow my journey here is to subscribe to
the RSS feed or to follow me on <a href="https://twitter.com/gianarb">@twitter</a>.</p>

  <h3 id="what-is-this-project">what is this project?</h3>

  <p>I had this idea to create a mechanism to enable other people that uses twitter
to follow a group of leaders in a particular space. I decided to start from the
observability (#o11y) because it is the area where I am in at the moment.</p>

  <p><a href="https://o11y.guru">o11y.guru</a> is pretty simple, a list of faces and a
button, they you press it and if you will authorize the twitter application you
will get to follow them.</p>

  <h3 id="table-of-content">Table of Content</h3>

  <ol>
    <li><a href="/blog/o11yguru-introduction">First day and first set of iterations</a></li>
    <li>Build process and automation driven by simplicity</li>
    <li>Monitoring and instrumentation with Honeycomb</li>
    <li><a href="/blog/o11yguru-history-first-bug">The history of the first bug</a></li>
    <li>OpenTelemetry it is time to embrace a unicorn standard</li>
    <li>The magic of structured logging</li>
    <li>Infrastructure monitoring with InfluxCloud</li>
    <li>Infrastructure as code with Terraform and CherryServer. First deploy.</li>
    <li>FAQ</li>
  </ol>

</div>

<p><img src="/img/o11y-guru-series/index.png" alt="" class="img-fluid" /></p>

<p>olly.guru is a website that I wrote in Go. It lists a group of people active on
twitter that I like to follow around monitoring, reliability, observability. It
allows you to follow them all in once as well.</p>

<p>A few years ago when I was developing almost in PHP somebody from the community,
I don’t remember who was, I am getting old, did a similar website and I thought
it was a great idea.</p>

<p>Since then, the project was in the back, in my mind. I am a lazy person when it
comes to writing code. I think there is enough useless code around, and I don’t
want to incentive that practice. That’s why I tend to write as less code I can.</p>

<p>There are a bunch of reasons why I changed my mind, and I started to do it:</p>

<p>Better mood and I had to try Honeycomb.io, but I never had the right
opportunity. I didn’t want to try it with a demo running on my laptop.  I
have a couple of new friends from CherryServer that supports my crazy ideas, and
I was looking for a reason to glue a bunch of reliable infrastructure as code that I
actually like. Even if it is usually a task I hate, mainly because there is no code
involved.</p>

<p>As Docker Captain and CNCF Ambassador, I have the feeling than a project like
that can be re-used.</p>

<p>I made the mistake that everyone does; I started to think about cool technologies
and not the problem I was going to solve or the project I was going to write.</p>

<p>I made a react application, just the foldering, and I quickly realized that I do not
know how to React, and I was wasting my time. But for this project, I got lucky
enough to keep going. I started to think about the problem again, and I decided
to make it as simple as possible. In practice almost everything gets generated
by an html template and a piloted by a list of names in a <code>txt</code> file. Very easy!</p>

<pre><code>.
├── cmd
│   ├── generate
│   └── www
├── Dockerfile
├── go.mod
├── go.sum
├── index.tmpl
├── Makefile
├── people
│   └── people.go
├── people.txt
├── style
│   ├── css
│   ├── fonts
│   ├── img
│   ├── index.html
│   ├── js
│   ├── node_modules
│   ├── package.json
│   ├── package-lock.json
│   └── scss
├── vendor
└── www
</code></pre>

<p>You can see the shape of the project; it has a minimal amount of technologies
involved: Go, HTML, Bootstrap 4, and a bit of Javascript.  I started from the
<code>style</code> directory. I use it for prototyping the HTML, CSS part. I am far away to
be good with colors and CSS, and I am cool with that, we do not like each other.
So I do all my tests there, and when I am ready, I port the <code>style/index.html</code>
into <code>index.tmpl.</code> I started from a Bootstrap 4 layout already done as you can
see. It is in their documentation.</p>

<p><img src="/img/o11y-guru-series/sheldon.jpeg" alt="" /></p>

<p><code>index.tmpl</code> is the template I use to render the actual homepage.  <code>www</code> is the
target destination for all the static files and the generated index page. I use
Make to copy files from <code>style</code> into <code>www,</code> and I wrote a CLI that generates the
HTML and it populates it with Twitter informations. It is inside <code>./cmd/generate.</code></p>

<p><code>./people.txt</code> is the list of twitter gurus. It is just a list:</p>

<pre><code>gianarb
rakyll
</code></pre>

<p>The <code>cmd/generate</code> reads that file and, it gets the information it needs from
the Twitter API like user bio, avatar and it renders the <code>./index.tmpl</code>
into the actual index inside the <code>www</code> folder.</p>

<p><code>./cmd/www</code> is an HTTP server written Go that serves the content of the <code>www</code>
directory. Plus it uses:</p>

<pre><code>github.com/dghubble/go-twitter
github.com/dghubble/gologin/v2
</code></pre>

<p>To manage the Twitter authentication flow.</p>

<p>I am sure you are wondering, “is he gonna open-source that!?”. I am. Not now.
The project needs to refactoring and some code needs to get stronger around
instrumentation and logging. As you see in the introduction, I am using this
experience as a use case to write down a bunch of practices I like or that I
would like to investigate.
So stay tuned! It will be available very soon.</p>

<h2 id="tldr-lesson-learned">tldr lesson learned</h2>

<p>Some of lessons I learned comes from how I am, but hey, this is my blog, I can
do whatever I like!
It is refreshing to start a project, but <strong>it is way cooler to have something to
show</strong>. So be careful when you start it, get it right so you won’t get tired.</p>

<p><strong>Set clear goals</strong>, and see point 1, they need to be very easy to
achieve, at least at the beginning.</p>

<p><strong>Do not type on your terminal, but write bash scripts.</strong> I started to do this
months ago at work. Bash scripts are way better than random commands in a
terminal because you can move them around composing way more powerful workflows.
You won’t lose them. That’s how I built my Makefile, just from the terminal
history or from the shortcut I made along the way.
Often a well-done <strong>dotenv file is enough to manage everything you need</strong>.</p>

<h2 id="lets-get-to-some-code">let’s get to some code</h2>

<p>I told you about bash scripts and Makefile, I will write a post about automation
for a small project, but this is part of my Makefile:</p>

<pre><code>style/build:
    cd ./style &amp;&amp; npm install
    cp -r ./style/node_modules/jquery/dist/jquery.js ./style/js/jquery.js
    cp ./style/node_modules/@fortawesome/fontawesome-free/js/all.js ./style/js/
    cp -r ./style/node_modules/@fortawesome/fontawesome-free/webfonts ./style/fonts
    cd ./style &amp;&amp; npm run scss

style/start: style/build
    cd ./style &amp;&amp; npm start

style/compile: style/build
    rm -rf ./www
    mkdir ./www
    cp -r ./style/img ./www
    cp -r ./style/fonts ./www
    cp -r ./style/css ./www
    cp -r ./style/js ./www
</code></pre>

<p>People can do the same with npm and, a hundred node packages, I like to keep
things simple at this point to avoid unnecessary blockers that will get my
tired. This is how I manage the <code>style</code> directory and how I build the <code>www</code> one.</p>

<blockquote>
  <p>With blockers I mean: googling around for things that should be easy.</p>
</blockquote>

<pre><code class="language-go">flag.StringVar(&amp;flags.consumerKey, "consumer-key", "", "Twitter Consumer Key")
flag.StringVar(&amp;flags.consumerSecret, "consumer-secret", "", "Twitter Consumer Secret")
flag.StringVar(&amp;flags.accessToken, "access-token", "", "Twitter access key")
flag.StringVar(&amp;flags.accessSecret, "access-secret", "", "Twitter access secret")
flag.StringVar(&amp;flags.guruFile, "guru-file", "", "File that contains the guru's name")
flag.StringVar(&amp;flags.indexTemplate, "index-template", "", "File that contains the guru's name")
flag.Parse()
flagutil.SetFlagsFromEnv(flag.CommandLine, "TWITTER")

config := oauth1.NewConfig(flags.consumerKey, flags.consumerSecret)
token := oauth1.NewToken(flags.accessToken, flags.accessSecret)
httpClient := config.Client(oauth1.NoContext, token)

// Twitter client
client := twitter.NewClient(httpClient)

// Verify Credentials
verifyParams := &amp;twitter.AccountVerifyParams{
    SkipStatus:   twitter.Bool(true),
    IncludeEmail: twitter.Bool(true),
}
_, _, err := client.Accounts.VerifyCredentials(verifyParams)
if err != nil {
    println(err.Error())
    os.Exit(1)
}

gurus := []*twitter.User{}

lines, err := people.ReadLineByLine(flags.guruFile)
if err != nil {
    println(err.Error())
    os.Exit(1)
}
for _, eachline := range lines {
    user, _, err := client.Users.Show(&amp;twitter.UserShowParams{
        ScreenName: eachline,
    })
</code></pre>

<p>The generate command is straightforward, I get over the <code>people.txt</code> file line
by line, and for every record, I get information about the user. When I have the
slice of gurus populated I render the template:</p>

<pre><code class="language-go">t, err := template.ParseFiles(flags.indexTemplate)
if err != nil {
    panic(err)
}
err = t.Execute(os.Stdout, Render{
    Gurus: gurus,
})
</code></pre>
<p>I decided to print the HTML into the stdout because it is way easier to use <code>&gt;</code>
other than accepting another parameter to specify the target output.</p>

<p>LDD: laziness driven development.</p>

<p>The <code>cmd/www</code> uses the same people.txt file to know who to follow when the user
presses the <code>Follow</code> button and authorize the twitter application:</p>

<pre><code class="language-go">for _, eachline := range lines {
    if strings.EqualFold(eachline, me.ScreenName) {
        continue
    }
    time.Sleep(5 * time.Second)
    err = newFriendship(ctx, twitterClient, eachline)
    if err != nil {
        logger.Warn(err.Error(), zap.String("follower_screenname", eachline), zap.Error(err))
    }
}
</code></pre>

<h2 id="the-project-in-the-project">The project in the project</h2>

<p>This series of posts I am writing is a side project in the side project. As I
wrote earlier I like to share what and why I do things. I hope to keep having
practical experiences to write down.</p>

<p>The high level expectation I set are:</p>

<ol>
  <li>Have fun</li>
  <li>Create a good network of followers on twitter that likes to speak about
observability</li>
  <li>Learning how Honeycomb works and why everybody says that it sounds like magic</li>
  <li>Writing down something about code instrumentation, infrastructure as a code and
automation</li>
  <li>Exercise my experience as a decision maker driven by simplicity and
efficiency.</li>
  <li>I hope to work with a couple of friends from Docker, HashiCorp,
CherryServier, InfluxData, HoneyComb to help me out with secret management,
monitoring, terraform and, automation in order to build the coolest project
ever. You will get an email from me (or reach out if you have suggestions).</li>
</ol>

<h2 id="thats-it">That’s it</h2>

<p>I am sure it gets out clearly from this article the friction between the
excitement about having an idea and the effort to make it real, even when it is
as simple as a single html page.. I struggle with
that all the time, and the laziness usually wins. Will this time be different?!
Well, I have a domain that is not a blank page. I think it is a good starting
point.</p>

<p>Time matter and have fun!</p>

<p><img src="/img/o11y-guru-series/sleep.jpg" alt="" class="img-fluid" /></p>

    </article>
</main>


      <small class="footer">Something weird with this website? <a href="https://github.com/gianarb/gianarb.github.com/issues/new" target="_blank">Let me know</a>.</small>

    </body>
</html>

